{"version":3,"sources":["webpack:///webpack/bootstrap e7ab99ab677ce8356725","webpack:///./src/anim-sequence.js"],"names":["FUNC_KEYS","MSPF","requestAnim","window","requestAnimationFrame","mozRequestAnimationFrame","webkitRequestAnimationFrame","msRequestAnimationFrame","callback","setTimeout","cancelAnim","cancelAnimationFrame","mozCancelAnimationFrame","webkitCancelAnimationFrame","msCancelAnimationFrame","requestID","clearTimeout","isFinite","Number","value","tasks","newAnimId","animTasks","playing","step","now","Date","next","call","forEach","task","timeLen","loops","frame","framesStart","duration","count","loopsLeft","frames","lastFrame","reverse","length","frameCallback","timeRatio","outputRatio","Math","floor","round","anim_lastPlaying","anim_watchStart","anim_watchTimer","setInterval","document","body","style","backgroundColor","anim_watchStop","clearInterval","startTask","AnimSequence","add","valueCallback","timing","animId","stepX","stepT","nextX","t","point","getPoint","t2","t3","t1","t12","p1f","p2f","x","y","newFrame","push","remove","iRemove","some","i","splice","start","stop","getTimeRatioByFrame","validTiming","Array","isArray","every"],"mappings":"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","file":"anim-sequence.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap e7ab99ab677ce8356725","/*\n * AnimSequence\n * https://anseki.github.io/anim-sequence/\n *\n * Copyright (c) 2017 anseki\n * Licensed under the MIT license.\n */\n\n// *** Currently, this code except `export` is not ES2015. ***\n\nvar\n  FUNC_KEYS = {\n    'ease': [0.25, 0.1, 0.25, 1],\n    'linear': [0, 0, 1, 1],\n    'ease-in': [0.42, 0, 1, 1],\n    'ease-out': [0, 0, 0.58, 1],\n    'ease-in-out': [0.42, 0, 0.58, 1]\n  },\n  MSPF = 1000 / 60 / 2, // precision ms/frame (FPS: 60)\n\n  requestAnim = window.requestAnimationFrame ||\n    window.mozRequestAnimationFrame ||\n    window.webkitRequestAnimationFrame ||\n    window.msRequestAnimationFrame ||\n    function(callback) { setTimeout(callback, MSPF); },\n\n  cancelAnim = window.cancelAnimationFrame ||\n    window.mozCancelAnimationFrame ||\n    window.webkitCancelAnimationFrame ||\n    window.msCancelAnimationFrame ||\n    function(requestID) { clearTimeout(requestID); },\n\n  isFinite = Number.isFinite || function(value) { return typeof value === 'number' && window.isFinite(value); },\n\n  /**\n   * @callback frameCallback\n   * @param {} value - A value that was made by `valueCallback`.\n   * @param {boolean} finish\n   * @param {number} timeRatio - Progress [0, 1].\n   * @param {number} outputRatio - Progress [0, 1].\n   * @returns {} `false` to stop.\n   */\n\n  /**\n   * @typedef {Object} task\n   * @property {number} animId\n   * @property {frameCallback} frameCallback - Callback that is called each frame.\n   * @property {number} duration\n   * @property {number} count - `0` as infinite.\n   * @property {{value, timeRatio: number, outputRatio: number}[]} frames\n   * @property {(number|null)} framesStart - The time when first frame ran, or `null` if it is not playing.\n   * @property {number} loopsLeft - A counter for loop.\n   * @property {number} lastFrame - index of last frame that ran.\n   * @property {boolean} reverse - Play backwards.\n   */\n\n  /** @type {task[]} */\n  tasks = [],\n  newAnimId = 0,\n  requestID;\n\nwindow.animTasks = tasks; // [DEBUG/]\nwindow.MSPF = MSPF; // [DEBUG/]\n\nvar playing; // [DEBUG/]\n\nfunction step() {\n  playing = true; // [DEBUG/]\n  var now = Date.now(), next = false;\n  if (requestID) {\n    cancelAnim.call(window, requestID);\n    requestID = null;\n  }\n\n  tasks.forEach(function(task) {\n    var timeLen, loops, frame;\n\n    if (!task.framesStart) { return; }\n    timeLen = now - task.framesStart;\n\n    if (timeLen >= task.duration && task.count && task.loopsLeft <= 1) {\n      frame = task.frames[(task.lastFrame = task.reverse ? 0 : task.frames.length - 1)];\n      task.frameCallback(frame.value, true, frame.timeRatio, frame.outputRatio);\n      task.framesStart = null;\n      return;\n    }\n    if (timeLen > task.duration) {\n      loops = Math.floor(timeLen / task.duration);\n      if (task.count) {\n        if (loops >= task.loopsLeft) { // Here `task.loopsLeft > 1`\n          frame = task.frames[(task.lastFrame = task.reverse ? 0 : task.frames.length - 1)];\n          task.frameCallback(frame.value, true, frame.timeRatio, frame.outputRatio);\n          task.framesStart = null;\n          return;\n        }\n        task.loopsLeft -= loops;\n      }\n      task.framesStart += task.duration * loops;\n      timeLen = now - task.framesStart;\n    }\n\n    if (task.reverse) { timeLen = task.duration - timeLen; }\n    frame = task.frames[(task.lastFrame = Math.round(timeLen / MSPF))];\n    if (task.frameCallback(frame.value, false, frame.timeRatio, frame.outputRatio\n        /* [DEBUG] */, timeLen/* [/DEBUG] */) !== false) {\n      next = true;\n    } else {\n      task.framesStart = null;\n    }\n  });\n\n  if (next) { requestID = requestAnim.call(window, step); }\n}\n\n// [DEBUG]\nwindow.anim_lastPlaying = false;\nwindow.anim_watchStart = function() {\n  window.anim_watchTimer = setInterval(function() {\n    if (playing !== window.anim_lastPlaying) {\n      document.body.style.backgroundColor = playing ? '#f7f6cb' : '#fff'; // not `''` for TRIDENT bug\n      window.anim_lastPlaying = playing;\n    }\n    playing = false;\n  }, 200);\n};\nwindow.anim_watchStop = function() { clearInterval(window.anim_watchTimer); };\n// [/DEBUG]\n\nfunction startTask(task, timeRatio) {\n  task.framesStart = Date.now();\n  if (timeRatio != null) {\n    task.framesStart -= task.duration * (task.reverse ? 1 - timeRatio : timeRatio);\n  }\n  task.loopsLeft = task.count;\n  task.lastFrame = null;\n  step();\n}\n\nvar AnimSequence = {\n  /**\n   * Callback that makes value that is required by each frame.\n   * @callback valueCallback\n   * @param {number} outputRatio - Progress [0, 1].\n   * @returns {}\n   */\n\n  /**\n   * @param {(valueCallback|null)} valueCallback - valueCallback\n   * @param {frameCallback} frameCallback - task property\n   * @param {number} duration - task property\n   * @param {number} count - task property\n   * @param {(string|number[])} timing - FUNC_KEYS or [x1, y1, x2, y2]\n   * @param {(boolean|null)} reverse - playing property\n   * @param {number|boolean} [timeRatio] - Play from the midst. [0, 1], or `false` that prevents it starting.\n   * @returns {number} animId to control the task.\n   */\n  add: function(valueCallback, frameCallback, duration, count, timing, reverse, timeRatio) {\n    var animId = ++newAnimId, task, frames,\n      stepX, stepT, nextX, t, point;\n\n    function getPoint(t) {\n      var t2 = t * t, t3 = t2 * t, t1 = 1 - t, t12 = t1 * t1,\n        p1f = 3 * t12 * t, p2f = 3 * t1 * t2;\n      return {\n        x: p1f * timing[0] + p2f * timing[2] + t3,\n        y: p1f * timing[1] + p2f * timing[3] + t3\n      };\n    }\n\n    function newFrame(timeRatio, outputRatio) {\n      return {value: valueCallback(outputRatio),\n        timeRatio: timeRatio, outputRatio: outputRatio};\n    }\n\n    if (typeof timing === 'string') { timing = FUNC_KEYS[timing]; }\n    valueCallback = valueCallback || function() {};\n\n    // Generate `frames` list\n    if (duration < MSPF) {\n      frames = [newFrame(0, 0), newFrame(1, 1)];\n    } else {\n      stepX = MSPF / duration;\n      frames = [newFrame(0, 0)];\n\n      if (timing[0] === 0 && timing[1] === 0 && timing[2] === 1 && timing[3] === 1) { // linear\n        for (nextX = stepX; nextX <= 1; nextX += stepX) {\n          frames.push(newFrame(nextX, nextX)); // x === y\n        }\n\n      } else {\n        stepT = stepX / 10; // precision for `t`\n        nextX = stepX;\n        for (t = stepT; t <= 1; t += stepT) {\n          point = getPoint(t);\n          if (point.x >= nextX) {\n            frames.push(newFrame(point.x, point.y));\n            nextX += stepX;\n          }\n        }\n      }\n\n      frames.push(newFrame(1, 1)); // for tolerance\n    }\n\n    task = {\n      animId: animId,\n      frameCallback: frameCallback, duration: duration, count: count, // task properties\n      frames: frames,\n      reverse: !!reverse\n    };\n    tasks.push(task);\n    if (timeRatio !== false) { startTask(task, timeRatio); }\n\n    return animId;\n  },\n\n  remove: function(animId) {\n    var iRemove;\n    if (tasks.some(function(task, i) {\n      if (task.animId === animId) {\n        iRemove = i;\n        task.framesStart = null; // for `tasks.forEach` that is playing now.\n        return true;\n      }\n      return false;\n    })) {\n      tasks.splice(iRemove, 1);\n    }\n  },\n\n  /**\n   * @param {number} animId - Target task.\n   * @param {boolean} reverse - Play backwards.\n   * @param {number} [timeRatio] - Play from the midst. [0, 1]\n   * @returns {void}\n   */\n  start: function(animId, reverse, timeRatio) {\n    tasks.some(function(task) {\n      if (task.animId === animId) {\n        task.reverse = !!reverse;\n        startTask(task, timeRatio);\n        return true;\n      }\n      return false;\n    });\n  },\n\n  /**\n   * @param {number} animId - Target task.\n   * @param {boolean} [getTimeRatioByFrame] - Return timeRatio of last frame that ran. [0, 1]\n   * @returns {(number|undefined)} timeRatio [0, 1]\n   */\n  stop: function(animId, getTimeRatioByFrame) {\n    var timeRatio;\n    tasks.some(function(task) {\n      if (task.animId === animId) {\n        if (!getTimeRatioByFrame) {\n          timeRatio = (Date.now() - task.framesStart) / task.duration;\n          if (task.reverse) { timeRatio = 1 - timeRatio; }\n          if (timeRatio < 0) {\n            timeRatio = 0;\n          } else if (timeRatio > 1) {\n            timeRatio = 1;\n          }\n        } else if (task.lastFrame != null) {\n          timeRatio = task.frames[task.lastFrame].timeRatio;\n        }\n        task.framesStart = null;\n        return true;\n      }\n      return false;\n    });\n    return timeRatio;\n  },\n\n  validTiming: function(timing) {\n    return typeof timing === 'string' ? FUNC_KEYS[timing] :\n      Array.isArray(timing) && [0, 1, 2, 3].every(function(i) {\n        return isFinite(timing[i]) && timing[i] >= 0 && timing[i] <= 1;\n      }) ? [timing[0], timing[1], timing[2], timing[3]] :\n      null;\n  }\n};\n\nexport default AnimSequence;\n\n\n\n// WEBPACK FOOTER //\n// ./src/anim-sequence.js"],"sourceRoot":""}